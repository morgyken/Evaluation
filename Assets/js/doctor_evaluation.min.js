$(document).ready(function(){$(".wh").keyup(function(){j()});$(".bmi").keyup(function(){k()});function k(){var r=$("#weight").val();var o=$("#height").val();var q="N/A";var p="N/A";if(o&&r){q=(r/(o*o)).toFixed(4);if(q>29.9){p="Obese"}else{if(q<30&&q>24.9){p="Overweight"}else{if(q<24.8&&q>18.5){p="Normal"}else{if(q<18.5){p="Underweight"}}}}}$("#bmi").html(q);$("#bmi_status").html(p)}function j(){var q=$("#hip").val();var p=$("#waist").val();var o="N/A";if(q&&p){o=(p/q).toFixed(4)}$("#ratio").html(o)}$("#vitals_form").submit(function(o){o.preventDefault();g()});$("#vitals_form input").blur(function(){g()});$("#vitals_form textarea").blur(function(){g()});function g(){var o=$("#vitals_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=$("#vitals_form").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:VITALS_URL,data:o.serialize()})}$("#notes_form").submit(function(o){o.preventDefault();e()});$("#notes_form input").blur(function(){e()});$("#notes_form textarea").blur(function(){e()});function e(){var o=$("#notes_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=$("#notes_form").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:NOTES_URL,data:o.serialize()})}$("#prescription_form").submit(function(o){o.preventDefault();l()});function l(){var p=$("#prescription input[name=drug]").val();var q=$("#prescription input[name=duration]").val();var o=$("#prescription input[name=take]").val();$("#prescribed > tbody").append("<tr><td>"+p+"</td><td>"+o+"</td><td>"+q+"</td></tr>");var r=$("#prescription").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');r=$("#prescription").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:PRESCRIPTION_URL,data:r.serialize()});$("#prescription").find("input[type=text]").val("")}$("#eye_preview_form input").blur(function(o){a()});$("#eye_preview_form").submit(function(o){o.preventDefault();a()});function a(){var o=$("#eye_preview_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=$("#eye_preview_form").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:PRELIMINARY_EXAMINATION,data:o.serialize()})}$("#visit_date").datepicker({dateFormat:"yy-mm-dd",minDate:"-100y",onSelect:function(){b()},constrainInput:false});$("#visit_date_form").submit(function(o){o.preventDefault();b()});function b(){var o=$("#visit_date_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=$("#visit_date_form").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:SET_DATE_URL,data:o.serialize(),success:function(){$("#visitdate").html("<i class='fa fa-check-circle'></i> Visit date set")}})}$(".accordion").accordion({heightStyle:"content"});$(".instructions").hide();$("#diagnosis_form input,#diagnosis_form textarea,#laboratory_form input,#laboratory_form textarea").blur(function(){d()});$("#laboratory_form .check,#diagnosis_form .check").click(function(){var p=$(this).parent().parent().find("input");var o=$(this).parent().parent().find("textarea");if($(this).is(":checked")){p.prop("disabled",false);o.prop("disabled",false);$(o).parent().show()}else{p.prop("disabled",true);o.prop("disabled",true);$(o).parent().hide()}$(this).prop("disabled",false);d()});function d(){$("#diagnosisTable").css("display","block");$("#diagnosisInfo > tbody > tr").remove();var o=0;$("#diagnosis_form input:checkbox:checked").each(function(){var q=$(this).val();var p=$("#name"+q).html();var r=$("#cost"+q).val();o+=parseInt(r);$("#diagnosisInfo > tbody").append("<tr><td>"+p+"</td><td>"+r+"</td></tr>")});$("#laboratory_form input:checkbox:checked").each(function(){var q=$(this).val();var p=$("#name"+q).html();var r=$("#cost"+q).val();o+=parseInt(r);$("#diagnosisInfo > tbody").append("<tr><td>"+p+"</td><td>"+r+"</td></tr>")});console.log(o);if(o){$("#diagnosisInfo > tbody").append("<tr><td>Total</td><td><strong>"+o+"</strong></td></tr>")}h();m()}$("#saveDiagnosis").click(function(){h();m()});function h(){var o=$("#diagnosis_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=o.append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');o=o.append('<input type="hidden" name="type" value="diagnosis" /> ');$.ajax({type:"POST",url:DIAGNOSIS_URL,data:o.serialize()})}function m(){var o=$("#laboratory_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=o.append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');o=o.append('<input type="hidden" name="type" value="laboratory" /> ');$.ajax({type:"POST",url:DIAGNOSIS_URL,data:o.serialize()})}$("#treatment_form input").blur(function(){n()});$("#treatment_form .check").click(function(){var o=$(this).parent().parent().find("input");if($(this).is(":checked")){o.prop("disabled",false)}else{o.prop("disabled",true)}$(this).prop("disabled",false);n()});function n(){$("#tableHolder").css("display","block");$("#treatment > tbody > tr").remove();var o=0;$("#treatment_form input:checkbox:checked").each(function(){var q=$(this).val();var p=$("#name"+q).html();var s=$("#cost"+q).val();var r=$("#no"+q).val();o+=(s*r);$("#treatment > tbody").append("<tr><td>"+p+"</td><td>"+s+"</td><td>"+r+"</td></tr>")});if(o){$("#treatment > tbody").append("<tr><td>Total</td><td><strong>"+o+"</strong></td><td></td></tr>")}c()}$("#saveTreatment").click(function(){c()});function c(){var o=$("#treatment_form").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=$("#treatment_form").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:TREAT_URL,data:o.serialize()})}$(".date").datepicker({dateFormat:"yy-mm-dd",minDate:0});$(".time").timeAutocomplete({increment:10,auto_value:false});$("#opnotes").submit(function(o){o.preventDefault();i()});$("#opnotes textarea").blur(function(){i()});function i(){var o=$("#opnotes").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');o=$("#opnotes").append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:OPNOTES_URL,data:o.serialize()})}$("#next_steps input").click(function(){f()});function f(){var o=$("#next_steps_result");o.hide();var p=$("#next_steps").append('<input type="hidden" name="visit" value="'+VISIT_ID+'" /> ');p=p.append('<input type="hidden" name="user" value="'+USER_ID+'" /> ');$.ajax({type:"POST",url:VISIT_METAS_URL,data:p.serialize(),success:function(q){if(q){o.html('<br/><i class="fa fa-check-circle"></i> Next steps saved');o.show()}}})}});